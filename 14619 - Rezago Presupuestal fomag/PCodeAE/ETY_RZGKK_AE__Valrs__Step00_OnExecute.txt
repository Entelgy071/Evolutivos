ETY_RPRZGKK_AET.WHERE_CLAUSE = "";

If All(ETY_REZAGKK_AET.DEPTID) And
      ETY_REZAGKK_AET.DEPTID <> "TODOS" Then
   
   If ETY_REZAGKK_AET.DEPTID = "SIN_DPTO" Then
      ETY_RPRZGKK_AET.WHERE_CLAUSE.Value = " AND A.DEPTID = ''";
   Else
      ETY_RPRZGKK_AET.WHERE_CLAUSE.Value = " AND A.DEPTID = '" | ETY_REZAGKK_AET.DEPTID.Value | "%'";
   End-If;
End-If;

MessageBox(0, "", 0, 0, "ETY_RPRZGKK_AET.TREE_NODE.Value:-->" | ETY_RPRZGKK_AET.TREE_NODE.Value);
MessageBox(0, "", 0, 0, "ETY_RPRZGKK_AET.ACCOUNT.Value:---->" | ETY_RPRZGKK_AET.ACCOUNT.Value);

If ETY_RPRZGKK_AET.TREE_NODE.Value <> "TODAS" Or
      ETY_RPRZGKK_AET.ACCOUNT.Value <> "TODAS" Then
   rem ETY_RPRZGKK_AET.TREE_NODE.Value <> "0" Then;
   
   If ETY_REZAGKK_AET.TREE_LEVEL_NUM > 6 Then
      
      rem MessageBox(0, "", 0, 0, " ACCOUNT->" | ETY_RPRZGKK_AET.ACCOUNT.Value);
      If All(ETY_RPRZGKK_AET.ACCOUNT) Then
         ETY_RPRZGKK_AET.WHERE_CLAUSE.Value = ETY_RPRZGKK_AET.WHERE_CLAUSE.Value | " AND A.ACCOUNT = '" | ETY_RPRZGKK_AET.ACCOUNT.Value | "'";
         
         ETY_RPRZGKK_AET.WHERE_CLAUSE.Value = ETY_RPRZGKK_AET.WHERE_CLAUSE.Value | " GROUP BY A.ACCOUNT";
         
         rem MessageBox(0, "", 0, 0, "CLAUSULA ADICIONAL EN WHERE:->" | ETY_RPRZGKK_AET.WHERE_CLAUSE.Value);
      End-If;
   Else
      ETY_RPRZGKK_AET.WHERE_CLAUSE.Value = ETY_RPRZGKK_AET.WHERE_CLAUSE.Value | " AND A.ACCOUNT LIKE '" | ETY_RPRZGKK_AET.ACCOUNT.Value | "%'";
      ETY_RPRZGKK_AET.WHERE_CLAUSE.Value = ETY_RPRZGKK_AET.WHERE_CLAUSE.Value | " AND EXISTS (SELECT T.TREE_NODE FROM PS_ETY_KK_TREE_VW T WHERE A.ACCOUNT = T.TREE_NODE AND T.TREE_NAME = '" | ETY_REZAGKK_AET.TREE_NAME | "')";
      MessageBox(0, "", 0, 0, "ETY_REZAGKK_AET.TREE_LEVEL_NUM.Value:  ->" | ETY_REZAGKK_AET.TREE_LEVEL_NUM.Value);
      MessageBox(0, "", 0, 0, "ETY_RPRZGKK_AET.WHERE_CLAUSE.Value:    ->" | ETY_RPRZGKK_AET.WHERE_CLAUSE.Value);
      rem MessageBox(0, "", 0, 0, "CLAUSULA ADICIONAL EN WHERE CON LIKE:->" | ETY_RPRZGKK_AET.WHERE_CLAUSE.Value);
   End-If;
   
Else
   
   rem ETY_RPRZGKK_AET.WHERE_CLAUSE.Value = ETY_RPRZGKK_AET.WHERE_CLAUSE.Value | " AND A.ACCOUNT LIKE '" | ETY_RPRZGKK_AET.ACCOUNT.Value | "%'";
   ETY_RPRZGKK_AET.WHERE_CLAUSE.Value = ETY_RPRZGKK_AET.WHERE_CLAUSE.Value | " AND A.ACCOUNT LIKE '0%' ";
   ETY_RPRZGKK_AET.WHERE_CLAUSE.Value = ETY_RPRZGKK_AET.WHERE_CLAUSE.Value | " AND EXISTS (SELECT T.TREE_NODE FROM PS_ETY_KK_TREE_VW T WHERE A.ACCOUNT = T.TREE_NODE AND T.TREE_NAME = '" | ETY_REZAGKK_AET.TREE_NAME | "')";
   MessageBox(0, "", 0, 0, "ETY_RPRZGKK_AET.WHERE_CLAUSE.Value: Cuent=0 o = todas ->" | ETY_RPRZGKK_AET.WHERE_CLAUSE.Value);
   rem ETY_RPRZGKK_AET.WHERE_CLAUSE.Value = ETY_RPRZGKK_AET.WHERE_CLAUSE.Value | " AND A.ACCOUNT IN (SELECT T.TREE_NODE FROM PS_ETY_KK_TREE_VW T WHERE T.TREE_NAME = '" | ETY_REZAGKK_AET.TREE_NAME.Value | "')";
   rem MessageBox(0, "", 0, 0, "CLAUSULA ADICIONAL WHERE VACIA:->" | ETY_RPRZGKK_AET.WHERE_CLAUSE.Value);
End-If;

MessageBox(0, "", 0, 0, "ETY_RPRZGKK_AET.WHERE_CLAUSE.Value:->" | ETY_RPRZGKK_AET.WHERE_CLAUSE.Value);
MessageBox(0, "", 0, 0, "ETY_RPRZGKK_AET.DESCRFORMAL:       ->" | ETY_RPRZGKK_AET.DESCRFORMAL.Value);

ETY_RPRZGKK_AET.MONETARY_AMOUNT_01 = 0;
ETY_RPRZGKK_AET.AMT_11 = 0;
ETY_RPRZGKK_AET.AMT_12 = 0;
ETY_RPRZGKK_AET.AMT_13 = 0;
ETY_RPRZGKK_AET.AMT_14 = 0;
ETY_RPRZGKK_AET.MONETARY_AMOUNT_02 = 0;
ETY_RPRZGKK_AET.AMOUNT_2_1 = 0;
ETY_RPRZGKK_AET.AMOUNT_2_2 = 0;
ETY_RPRZGKK_AET.MONETARY_AMOUNT_03 = 0;
ETY_RPRZGKK_AET.AMOUNT_3_1 = 0;
ETY_RPRZGKK_AET.AMOUNT_3_2 = 0;
ETY_RPRZGKK_AET.MONETARY_AMOUNT_04 = 0;
ETY_RPRZGKK_AET.MONETARY_AMOUNT_05 = 0;
ETY_RPRZGKK_AET.MONETARY_AMOUNT_06 = 0;
ETY_RPRZGKK_AET.MONETARY_AMOUNT_07 = 0;
