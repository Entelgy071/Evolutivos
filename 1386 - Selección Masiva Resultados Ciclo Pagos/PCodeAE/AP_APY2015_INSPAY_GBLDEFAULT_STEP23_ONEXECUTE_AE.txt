Declare Function CalcValueDt PeopleCode PYCYCL_MTHD.VALUE_DT SaveEdit;

Evaluate PYCYCL_2_AET.CK_PYMNT_METHOD
When = "BOO"
When = "BEF"
When = "DFT"
   PYCYCL_2_AET.VALUE_DT = CalcValueDt(PYCYCL_2_AET.CK_PYMNT_DT, PYCYCL_2_AET.CK_BANK_SETID, PYCYCL_2_AET.CK_BANK_CD, PYCYCL_2_AET.CK_BANK_ACCT_KEY, PYCYCL_2_AET.CK_PYMNT_METHOD);
   Break;
When-Other
   SQLExec("select %DATEOUT(value_dt) from ps_pycycl_mthd where bank_setid = :1 and bank_cd = :2 and bank_acct_key = :3 and pymnt_method = :4 and pay_cycle = :5", PYCYCL_2_AET.CK_BANK_SETID, PYCYCL_2_AET.CK_BANK_CD, PYCYCL_2_AET.CK_BANK_ACCT_KEY, PYCYCL_2_AET.CK_PYMNT_METHOD, PYCYCL_2_AET.CK_PAY_CYCLE, PYCYCL_2_AET.VALUE_DT);
   If None(PYCYCL_2_AET.VALUE_DT) Then
      PYCYCL_2_AET.VALUE_DT = CalcValueDt(PYCYCL_2_AET.CK_PYMNT_DT, PYCYCL_2_AET.CK_BANK_SETID, PYCYCL_2_AET.CK_BANK_CD, PYCYCL_2_AET.CK_BANK_ACCT_KEY, PYCYCL_2_AET.CK_PYMNT_METHOD);
   End-If;
   Break;
End-Evaluate;

If None(PYCYCL_2_AET.VALUE_DT) Then
   PYCYCL_2_AET.VALUE_DT = PYCYCL_2_AET.CK_PYMNT_DT;
End-If;
